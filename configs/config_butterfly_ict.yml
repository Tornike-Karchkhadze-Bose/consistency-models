project_name: "i_consistancy_models_butterflies256"
log_directory: "lightning_logs"
mode: train # train | test

id:
  version: "bs=230x4_s_400000_s1=1280_ema_0.99993" #"adaptive_bs=128x4_s_200000_gpu-2"
  name: "ict_diff_lpips"


model:
    ema: True
    ema_rate: 0.999
    dropout: 0.0

training:
    batch_size: 230
    precision: 16
    max_epochs: 1000
    max_steps: 400000 # 400000
    warmup_epochs: 1
    accumulate_grad_batches: 4
    save_top_k: 1
    log_every_n_steps: 2
    validation_every_n_epochs:  # ???
    val_check_interval: 1000
    resume_from_checkpoint: #/home/tornike/consistency-models/lightning_logs/consistancy_models_butterflies256/2024-06-29T09-50-11_ct_diff_lpips_adaptive_bs=230x4_s_800000_gpu-1/checkpoints/last.ckpt
    devices: 
        # - 0
        - 1
        # - 2   
        # - 3

testing:
    batch_size: 512
    samples: 64
    calc_inception: True
    calc_fid: True

data:
    name: butterflies256 # cifar10 | butterflies256 | mnist
    num_workers: 4
    img_resolution : 32
    img_channels : 3

optim:
    grad_clip: null
    weight_decay: 0
    lr: 4.e-4
    betas: [0.9,0.999]
    eps: 1.e-8
    amsgrad: False
    optimizer : radam

diffusion:
    preconditioning: ict # vp | ve | edm | ct | ict
    N_and_mu: adaptive # adaptive | fixed
    mu_0 : 0.99993 #0.90
    s_0 : 10
    s_1 : 1280
    p_mean: -1.1
    p_std: 2.0 
    ct_dist_fn : pseudo_huber # l1 | l2 | lpips | pseudo_huber
